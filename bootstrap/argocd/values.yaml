argo-cd:
  global:
    domain: argocd.lancebramsey.com
  cluster:
    inClusterEnabled: false
  configs:
    cm:
      kustomize.buildOptions: --enable-helm
    secret:
      argocdServerAdminPassword: "$2y$10$KdfSAG57mO2CQk/JRJCbVeB7.11TYnS/AANxYF9OZjqd6VATKKzhG"
  crds:
    keep: true
  server:
    ingress:
      annotations:
        cert-manager.io/cluster-issuer: selfsigned-cluster-issuer
        nginx.ingress.kubernetes.io/app-root: /login
        nginx.ingress.kubernetes.io/backend-protocol: HTTPS
        nginx.ingress.kubernetes.io/ssl-passthrough: "true"
      enabled: true
      tls: true
      #extraTls:
      #- hosts:
      #  - argocd.lancebramsey.com
      #  secretName: argocd.lancebramsey.com-tls
      #hostname: argocd.lancebramsey.com
      ingressClassName: nginx
argocd-apps:
  projects:
    bootstrap:
      name: bootstrap
      namespace: argocd
      annotations: {}
      labels: {}
      description: 'Infrastructure project created in Helm chart'
      sourceRepos:
        - '*'
      destinations:
        - namespace: '*'
          server: '*'
      clusterResourceWhitelist:
        - group: '*'
          kind: '*'
      namespaceResourceWhitelist:
        - group: '*'
          kind: '*'
      roles:
        - name: read-only
          description: Read-only access
          policies:
            - p, proj:bootstrap:read-only, applications, get, bootstrap/*, allow
          groups:
            - bootstrap
      orphanedResources:
        warn: false
    infrastructure:
      name: infrastructure
      namespace: argocd
      annotations: {}
      labels: {}
      description: 'Infrastructure project created in Helm chart'
      sourceRepos:
        - '*'
      destinations:
        - namespace: '*'
          server: '*'
      clusterResourceWhitelist:
        - group: '*'
          kind: '*'
      namespaceResourceWhitelist:
        - group: '*'
          kind: '*'
      roles:
        - name: read-only
          description: Read-only access
          policies:
            - p, proj:infrastructure:read-only, applications, get, infrastructure/*, allow
          groups:
            - infrastructure
      orphanedResources:
        warn: false
    monitoring:
      name: monitoring
      namespace: argocd
      annotations: {}
      labels: {}
      description: 'Monitoring project created in Helm chart'
      sourceRepos:
        - '*'
      destinations:
        - namespace: '*'
          server: '*'
      clusterResourceWhitelist:
        - group: '*'
          kind: '*'
      namespaceResourceWhitelist:
        - group: '*'
          kind: '*'
      roles:
        - name: read-only
          description: Read-only access
          policies:
            - p, proj:monitoring:read-only, applications, get, monitoring/*, allow
          groups:
            - monitoring
      orphanedResources:
        warn: false
          
  applicationsets:
    bootstrap:
      namespace: argocd
      additionalLabels: {}
      additionalAnnotations: {}
      finalizers:
      - resources-finalizer.argocd.argoproj.io
      generators:
      - matrix:
          generators:
          - git:
              repoURL: https://github.com/Bravesguy18/argocd.git
              revision: HEAD
              directories:
                - path: bootstrap/*
          - clusters: {}
      ignoreApplicationDifferences:
      - jsonPointers:
        - /spec/syncPolicy
      template:
        metadata:
          name: '{{path.basename}}'
          labels:
            function: bootstrap
        spec:
          project: bootstrap
          source:
            repoURL: https://github.com/Bravesguy18/argocd.git
            targetRevision: HEAD
            path: '{{path}}'
          destination:
            name: '{{name}}'
            namespace: argocd
          syncPolicy:
            automated:
              prune: true
              selfHeal: true
            syncOptions:
              - CreateNamespace=true
    infrastructure:
      namespace: argocd
      additionalLabels: {}
      additionalAnnotations: {}
      finalizers:
      - resources-finalizer.argocd.argoproj.io
      generators:
      - matrix:
          generators:
          - git:
              repoURL: https://github.com/Bravesguy18/argocd.git
              revision: HEAD
              directories:
                - path: infrastructure/*
          - clusters: {}
      ignoreApplicationDifferences:
      - jsonPointers:
        - /spec/syncPolicy
      # Progressive Syncs is an experimental feature and it must be explicitly enabled
      # Ref: https://argo-cd.readthedocs.io/en/stable/operator-manual/applicationset/Progressive-Syncs/#enabling-progressive-syncs
      #strategy:
      #  type: RollingSync
      #  rollingSync:
      #    steps:
      #    - matchExpressions:
      #      - key: namespace
      #        operator: In
      #        values:
      #        - argocd
      #    - matchExpressions:
      #      - key: project
      #        operator: In
      #        values:
      #        - infrastructure
      template:
        metadata:
          name: '{{path.basename}}'
          labels:
            function: infrastructure
        spec:
          project: infrastructure
          source:
            repoURL: https://github.com/Bravesguy18/argocd.git
            targetRevision: HEAD
            path: '{{path}}'
          destination:
            name: '{{name}}'
            namespace: '{{path.basename}}'
          syncPolicy:
            automated:
              prune: true
              selfHeal: true
            syncOptions:
              - CreateNamespace=true
